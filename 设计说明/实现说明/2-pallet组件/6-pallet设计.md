# 说明
本文档描述了所需要增加的各个托盘，包括托盘的名称和主要实现的功能

# 委员会选举
## 托盘名称： 
committee
## 主要功能
通过去中心化协作的方式产生一个随机数，并且根据这个随机数和参与者的地址值，选择参与者中预定义的个数，从近到远排序，生成委员会成员
## 过程描述
监控时隙的编号，在第100到700之间，可以进行submit，并且区块对已经submit的进行记录,在701-900之间，可以进行reveal，并且区块同样对reveal进行验证；在第910块，进行统计计算，得到随机值和结果值，将结果通过DigestItem写入到区块中
## Applyable的动作
### submit
竞选过程，向链提交数字的哈希，注意这里是要锁定资产的
#### 参数：
    hash值
#### 返回结果
    无
### reveal
竞选过程，向链提交实际的字，注意如果签名正确，数字不正确，锁定的资产将被销毁
#### 参数：
    value值，一个u64类型
#### 返回结果
    无
## DigestItem
是一个Vec<AccountId>的数组，当MAX_COMMITTEE是2048时，这个值将会有40K字节，是每Epoch产生一次
## 数据存储项
### 投票信息
voteinfo:Map<AccountId,(hash,value)>
### 选举结果
committee:

# 代理投票
## 名称： 
vote
## 主要功能
根据在每个时隙序列号N，委员会中第`N*K+1`到`N*（K+1`）的节点是该时隙的投票代理，如果自身属于代理人，在该时隙开始后，延时一段时间等待投票请求，然后对投票请求结果
## 新增链下消息
### 投票请求
候选人节点向委员会分组发送投票请求，组内的非代理节点只转发，并不进行投票管理动作。
### 投票回应
投票代理向候选人回应投票结果
### 区块头广播
区块头在委员会组内广播，这样通知委员会内潜在的代理者，新的一个区块开始了。
### 惩罚
第一版本不实现  
## Applyable的动作
无
## DigestItem
当前使用的是普通的签名，因此是Vec<(priority,Vec<Signature>)>模式的签名结果，下一步改成BLS，进一步降低签名数据量。
## 数据存储项
无

# 区块头处理器
## 名称： 
header  worker
## 主要功能
header worker在接收到区块头，分析区块头生成交易，然后发送到对应的交易池中。
为了避免回滚，因此交易池中的区块头信息需要经过最终确定化后，才可以提交成为交易，这个过程使用transaction-pool中的validate功能实现。
## 新增链下消息
    
### 区块头广播
区块头广播后，由相应的offworker转换成
 
## Applyable的动作
  proc_relay(relay_seq,block_number)

## DigestItem
当前使用的是普通的签名，因此是Vec<(priority,Vec<Signature>)>模式的签名结果，下一步改成BLS，进一步降低签名数据量。
## 数据存储项
    无

# Beacon对区块处理
## 名称： 
beacon
## 主要功能
beacon根据锁定的各个中继链的区块，从锁定的中继链的区块中取出需要路中继交易的数据，重新按照目标中继排列后，再放入到区块中。即锁定的区块是这个区块执行的输入，重新排列后的结果是区块的输出。
## 新增链下消息
    
### 区块头广播
区块头广播后，由相应的offworker转换成
 
## Applyable的动作
  proc_relay(relay_seq,block_number)

## DigestItem
当前使用的是普通的签名，因此是Vec<(priority,Vec<Signature>)>模式的签名结果，下一步改成BLS，进一步降低签名数据量。
## 数据存储项
    无

# 中继对区块处理

## 名称： 
vote
## 主要功能
根据在每个时隙序列号N，委员会中第`N*K+1`到`N*（K+1`）的节点是该时隙的投票代理，如果自身属于代理人，在该时隙开始后，延时一段时间等待投票请求，然后对投票请求结果
## 新增链下消息
### 投票请求
    候选人节点向委员会分组发送投票请求，组内的非代理节点只转发，并不进行投票管理动作。
### 投票回应
    投票代理向候选人回应投票结果
### 区块头广播
    区块头在委员会组内广播，这样通知委员会内潜在的代理者，新的一个区块开始了。
### 惩罚
    后面一步再说    
## Applyable的动作
无
## DigestItem
    当前使用的是普通的签名，因此是Vec<(priority,Vec<Signature>)>模式的签名结果，下一步改成BLS，进一步降低签名数据量。
## 数据存储项
    无


# 分片对区块处理

## 名称： 
vote
## 主要功能
根据在每个时隙序列号N，委员会中第`N*K+1`到`N*（K+1`）的节点是该时隙的投票代理，如果自身属于代理人，在该时隙开始后，延时一段时间等待投票请求，然后对投票请求结果
## 新增链下消息
### 投票请求
    候选人节点向委员会分组发送投票请求，组内的非代理节点只转发，并不进行投票管理动作。
### 投票回应
    投票代理向候选人回应投票结果
### 区块头广播
    区块头在委员会组内广播，这样通知委员会内潜在的代理者，新的一个区块开始了。
### 惩罚
    后面一步再说    
## Applyable的动作
无
## DigestItem
    当前使用的是普通的签名，因此是Vec<(priority,Vec<Signature>)>模式的签名结果，下一步改成BLS，进一步降低签名数据量。
## 数据存储项
    无

# 跨链数据锁
## 托盘名称： 
datamutex
## 主要功能
跨链请求或是返回数据锁

## 过程描述
监控时隙的编号，在第100到700之间，可以进行submit，并且区块对已经submit的进行记录,在701-900之间，可以进行reveal，并且区块同样对reveal进行验证；在第910块，进行统计计算，得到随机值和结果值，将结果通过DigestItem写入到区块中
## Applyable的动作
### submit
竞选过程，向链提交数字的哈希，注意这里是要锁定资产的
#### 参数：
    hash值
#### 返回结果
    无
### reveal
竞选过程，向链提交实际的字，注意如果签名正确，数字不正确，锁定的资产将被销毁
#### 参数：
    value值，一个u64类型
#### 返回结果
    无
## DigestItem
是一个Vec<AccountId>的数组，当MAX_COMMITTEE是2048时，这个值将会有40K字节，是每Epoch产生一次
## 数据存储项
### 投票信息
voteinfo:Map<AccountId,(hash,value)>
### 选举结果
committee: