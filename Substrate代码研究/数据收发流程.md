# 数据收发流程
![](data-flow.png)

需要使用notification的，使用如上的方式进行数据传输。

1. 首先通过register_notificaitons_protocol把自身注册到notification处理器中

2. 使用 
   ```rust 
   network.event_stream().filter_map(|e| async move { match e {
       Event::Dht(e) => Some(e)
   }})
    ```
    1. network_service.event_stream()创建一个新的（tx,rx)对，然后向把tx推送给networker,返回rx
    2. networker里有一个event_streams，记录所有的tx
    3. 当需要发送数据的时候，向event_streams中所有的tx发送数据
    4. 所有监听rx的都可以收到消息，过滤消息给自己需要的使用（使用poll)

## 如果不使用notification方式